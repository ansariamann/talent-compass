@tailwind base;
@tailwind components;
@tailwind utilities;

/* SF Pro system font stack — identical to Apple's own websites */
@layer base {
  :root {
    /* ─── Apple HIG Colour Palette ──────────────────────────────────── */

    /* Backgrounds — layered white/near-white surfaces */
    --background:       0 0% 97%;      /* systemGroupedBackground  #F2F2F7 */
    --foreground:       0 0% 7%;       /* label                    #111111 */

    --card:             0 0% 100%;     /* secondaryGroupedBackground white  */
    --card-foreground:  0 0% 7%;

    --popover:          0 0% 100%;
    --popover-foreground: 0 0% 7%;

    /* Apple Blue — the single system accent */
    --primary:          211 100% 50%;  /* #007AFF */
    --primary-foreground: 0 0% 100%;

    /* Secondary surfaces */
    --secondary:        240 5% 96%;
    --secondary-foreground: 0 0% 20%;

    --muted:            240 4% 93%;
    --muted-foreground: 240 3% 46%;   /* secondaryLabel */

    --accent:           211 100% 50%; /* reuse Apple blue */
    --accent-foreground: 0 0% 100%;

    --destructive:      0 85% 55%;    /* systemRed */
    --destructive-foreground: 0 0% 100%;

    --border:           240 5% 88%;   /* separator — very subtle */
    --input:            0 0% 100%;
    --ring:             211 100% 50%;

    --radius:           0.6875rem;    /* 11px — Apple's modal corner radius */

    /* ─── Status colours ─────────────────────────────────────────────── */
    --status-success:   142 72% 36%;  /* systemGreen  */
    --status-warning:   36 100% 47%;  /* systemOrange */
    --status-error:     0 85% 55%;    /* systemRed    */
    --status-info:      211 100% 50%;
    --status-pending:   270 60% 58%;  /* systemPurple */
    --status-neutral:   240 3% 60%;

    /* ─── Surface tokens ─────────────────────────────────────────────── */
    --surface-elevated: 0 0% 100%;
    --surface-overlay:  240 5% 96%;
    --text-primary:     0 0% 7%;
    --text-secondary:   240 3% 46%;
    --text-tertiary:    240 3% 64%;

    /* ─── Shadows — Apple uses elevation, not glow ───────────────────── */
    --shadow-sm:  0 1px 2px hsl(0 0% 0% / 0.06), 0 1px 4px hsl(0 0% 0% / 0.04);
    --shadow-md:  0 2px 8px hsl(0 0% 0% / 0.08), 0 1px 2px hsl(0 0% 0% / 0.05);
    --shadow-lg:  0 8px 24px hsl(0 0% 0% / 0.10), 0 2px 4px hsl(0 0% 0% / 0.06);
    --shadow-glow: var(--shadow-md);       /* no colour glow in Apple HIG  */
    --shadow-glow-accent: var(--shadow-md);

    /* ─── Glass — used sparingly, e.g. header translucency ──────────── */
    --glass-bg:     hsl(0 0% 97% / 0.82);
    --glass-border: hsl(240 5% 84% / 0.8);
    --glass-blur:   20px;

    /* ─── Sidebar ────────────────────────────────────────────────────── */
    --sidebar-background:          240 5% 96%;
    --sidebar-foreground:          0 0% 10%;
    --sidebar-primary:             211 100% 50%;
    --sidebar-primary-foreground:  0 0% 100%;
    --sidebar-accent:              240 5% 90%;
    --sidebar-accent-foreground:   0 0% 10%;
    --sidebar-border:              240 5% 88%;
    --sidebar-ring:                211 100% 50%;

    /* ─── Gradients — minimal; reserved for data viz ─────────────────── */
    --gradient-primary: linear-gradient(135deg, hsl(211 100% 50%) 0%, hsl(211 100% 62%) 100%);
    --gradient-surface: linear-gradient(180deg, hsl(0 0% 100%) 0%, hsl(240 5% 97%) 100%);
    --gradient-glow:    none;
    --gradient-vibrant: var(--gradient-primary);
    --gradient-ocean:   var(--gradient-primary);
    --gradient-sunset:  var(--gradient-primary);

    /* ─── Motion — Apple spring curves ──────────────────────────────── */
    --transition-fast: 150ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
    --transition-base: 250ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
    --transition-slow: 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  /* Dark mode — macOS dark system colours */
  .dark {
    --background:       240 8% 10%;   /* systemBackground dark   #1C1C1E */
    --foreground:       0 0% 96%;

    --card:             240 6% 14%;   /* secondaryGroupedBackground dark */
    --card-foreground:  0 0% 96%;

    --popover:          240 6% 16%;
    --popover-foreground: 0 0% 96%;

    --primary:          211 100% 60%; /* lighter blue for dark bg          */
    --primary-foreground: 0 0% 100%;

    --secondary:        240 5% 18%;
    --secondary-foreground: 0 0% 82%;

    --muted:            240 5% 20%;
    --muted-foreground: 240 3% 55%;

    --accent:           211 100% 60%;
    --accent-foreground: 0 0% 100%;

    --destructive:      0 75% 60%;
    --destructive-foreground: 0 0% 100%;

    --border:           240 4% 22%;
    --input:            240 5% 18%;
    --ring:             211 100% 60%;

    --status-success:   142 60% 48%;
    --status-warning:   36 100% 55%;
    --status-error:     0 75% 60%;
    --status-info:      211 100% 60%;
    --status-pending:   270 60% 65%;
    --status-neutral:   240 3% 55%;

    --surface-elevated: 240 6% 16%;
    --surface-overlay:  240 5% 20%;

    --glass-bg:         hsl(240 8% 12% / 0.85);
    --glass-border:     hsl(0 0% 100% / 0.08);

    --sidebar-background:         240 6% 12%;
    --sidebar-foreground:         0 0% 88%;
    --sidebar-primary:            211 100% 60%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent:             240 5% 18%;
    --sidebar-accent-foreground:  0 0% 88%;
    --sidebar-border:             240 4% 20%;
    --sidebar-ring:               211 100% 60%;

    --shadow-sm:  0 1px 2px hsl(0 0% 0% / 0.3),  0 1px 4px hsl(0 0% 0% / 0.2);
    --shadow-md:  0 2px 8px hsl(0 0% 0% / 0.4),  0 1px 2px hsl(0 0% 0% / 0.3);
    --shadow-lg:  0 8px 24px hsl(0 0% 0% / 0.5), 0 2px 4px hsl(0 0% 0% / 0.35);
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    /* Apple uses system-ui which resolves to SF Pro on Apple devices */
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display',
                 'Helvetica Neue', Arial, system-ui, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  body {
    @apply bg-background text-foreground;
    font-size: 15px; /* SF Pro Text default reading size */
    line-height: 1.47; /* Apple's standard body line-height */
  }

  .font-mono {
    font-family: 'SF Mono', 'Fira Code', 'JetBrains Mono', ui-monospace, monospace;
    font-size: 0.875em;
  }

  /* ─── Apple-style ultra-thin scrollbar ─────────────────────── */
  ::-webkit-scrollbar {
    width: 5px;
    height: 5px;
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
    border-radius: 100px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--muted-foreground) / 0.5);
  }
}

@layer components {
  /* ─── Glass — only for translucent headers/toolbars ─────────── */
  .glass {
    background: var(--glass-bg);
    backdrop-filter: saturate(180%) blur(var(--glass-blur));
    -webkit-backdrop-filter: saturate(180%) blur(var(--glass-blur));
    border: 1px solid var(--glass-border);
  }

  .glass-strong {
    background: var(--glass-bg);
    backdrop-filter: saturate(200%) blur(30px);
    -webkit-backdrop-filter: saturate(200%) blur(30px);
    border: 1px solid var(--glass-border);
  }

  /* ─── Data table — Apple Numbers-inspired ───────────────────── */
  .data-table {
    @apply w-full border-collapse;
  }

  .data-table th {
    @apply text-left text-xs font-semibold uppercase tracking-wide px-4 py-3 border-b border-border;
    color: hsl(var(--muted-foreground));
    background: hsl(var(--secondary));
    letter-spacing: 0.04em;
  }

  .data-table td {
    @apply px-4 py-3 border-b border-border/60 text-sm;
  }

  .data-table tr {
    @apply transition-colors duration-100;
  }

  .data-table tr:hover td {
    background: hsl(var(--primary) / 0.04);
  }

  /* ─── Status badges — flat, colour-coded, no glow ───────────── */
  .status-badge {
    @apply inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium;
  }

  .status-badge--success {
    background: hsl(var(--status-success) / 0.12);
    color: hsl(var(--status-success));
  }
  .status-badge--warning {
    background: hsl(var(--status-warning) / 0.12);
    color: hsl(var(--status-warning));
  }
  .status-badge--error {
    background: hsl(var(--status-error) / 0.12);
    color: hsl(var(--status-error));
  }
  .status-badge--info {
    background: hsl(var(--status-info) / 0.12);
    color: hsl(var(--status-info));
  }
  .status-badge--pending {
    background: hsl(var(--status-pending) / 0.12);
    color: hsl(var(--status-pending));
  }
  .status-badge--neutral {
    @apply bg-muted text-muted-foreground;
  }

  /* ─── Keyboard hints ─────────────────────────────────────────── */
  .kbd {
    @apply inline-flex items-center justify-center min-w-[1.5rem] h-5 px-1.5
           rounded border text-[10px] font-mono bg-secondary
           border-border text-muted-foreground;
  }

  /* ─── Panel — borderless inset sections (like macOS Preferences) */
  .panel {
    @apply rounded-xl bg-card border border-border;
  }

  .panel-header {
    @apply px-4 py-3 flex items-center justify-between border-b border-border;
  }

  .panel-body {
    @apply p-4;
  }

  /* ─── AI Copilot message — subtle tint, no gradient border ─── */
  .ai-message {
    @apply relative pl-4 rounded-xl py-3 pr-4;
    background: hsl(var(--primary) / 0.06);
    border-left: 2px solid hsl(var(--primary) / 0.5);
  }

  .ai-message::before {
    content: '✦';
    @apply absolute -left-px top-3 text-xs;
    color: hsl(var(--primary));
  }

  /* ─── Gradient text — Apple blue only ────────────────────────── */
  .gradient-text {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* ─── Vibrant button — clean solid primary, no glow ─────────── */
  .btn-vibrant {
    @apply bg-primary text-primary-foreground font-medium;
    transition: all var(--transition-fast);
    box-shadow: var(--shadow-sm);
  }

  .btn-vibrant:hover {
    filter: brightness(1.08);
    transform: translateY(-0.5px);
    box-shadow: var(--shadow-md);
  }

  .btn-vibrant:active {
    transform: translateY(0);
    filter: brightness(0.96);
    box-shadow: none;
  }

  /* ─── Interactive card — elevation on hover, no colour leaking ─ */
  .card-interactive {
    transition: box-shadow var(--transition-fast), transform var(--transition-fast);
  }

  .card-interactive:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }

  /* ─── Gradient border — reserved; nearly invisible in Apple style */
  .gradient-border {
    position: relative;
    @apply bg-card rounded-xl border border-border;
  }

  .gradient-border::before {
    content: '';
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    padding: 1px;
    background: hsl(var(--primary) / 0.3);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0;
    transition: opacity var(--transition-fast);
  }

  .gradient-border:hover::before {
    opacity: 1;
  }

  /* ─── Icon glow → removed; Apple uses opacity instead ───────── */
  .icon-glow {
    transition: opacity var(--transition-fast);
  }

  .icon-glow:hover {
    opacity: 0.7;
  }
}

@layer utilities {
  .text-gradient {
    @apply bg-clip-text text-transparent;
    background-image: var(--gradient-primary);
  }

  .animate-pulse-subtle {
    animation: pulse-subtle 2.4s ease-in-out infinite;
  }

  @keyframes pulse-subtle {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.65; }
  }

  .animate-slide-in {
    animation: slide-in 0.22s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  @keyframes slide-in {
    from { transform: translateX(8px); opacity: 0; }
    to   { transform: translateX(0);   opacity: 1; }
  }

  .animate-fade-in {
    animation: fade-in 0.18s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  @keyframes fade-in {
    from { opacity: 0; }
    to   { opacity: 1; }
  }
}
